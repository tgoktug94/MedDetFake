# # ğŸ§¬ MedFakeDet 
### **MedFakeDet: Multi-Organ Medical Deepfake Detection and Inpainting Localization System via Effective Deep Learning Models and Density Maps**

**Authors:**  
- **Mehmet Karakose**, Firat University, Elazig, TÃ¼rkiye â€” *mkarakose@firat.edu.tr*  
- **T. GÃ¶ktuÄŸ AltundoÄŸan**, Celal Bayar University, Manisa, TÃ¼rkiye â€” *turan.altundogan@cbu.edu.tr*  
- **Mert Ã‡eÃ§en**, Firat University, Elazig, TÃ¼rkiye â€” *mert.cecen23@gmail.com*

---

## ğŸ“„ Abstract

The ability of deepfake technologies to produce highly realistic images has become a significant security concern for healthcare systems and insurance auditing processes, either through the generation of fake medical images or the realistic manipulation of original ones. This study employs effective deep learning methods to detect medical images generated by deepfake technologies and to localize inpainting-based manipulations. Two different datasets were constructed for this purpose: the MedFake dataset, which contains brain, lung, kidney, and chest images generated using multiple synthesis approaches; and the MedFakeInpaint dataset, which includes localized inpainting manipulations applied to brain images. For deepfake synthesis detection, an 8-class ResNet-based model was trained to jointly classify the organ type of a medical image and its real or fake status. For manipulation localization, a U-Net-based model was trained to predict density maps corresponding to manipulated regions within the image. Bounding boxes were subsequently derived from the predicted density maps to explicitly represent the localized manipulated regions. The performance of the proposed approach was evaluated using F1-score, and IoU-based localization metrics under strict training, validation, and test data splits with varying threshold values. The developed models were integrated into a backend system using FastAPI, and a lightweight web application was implemented to connect the provided endpoints with end users. MedFakeDet is released as a reproducible software package, including pretrained models and inference scripts. When the developed models were evaluated under different ablation configurations and threshold values, it was observed that in some configurations, the F1 score reached levels of up to 99%.

---

## ğŸ”‘ Keywords

`Medical Deepfake detection`, `Tumor Inpaint Detection`, ` Synthesis Detection`,  `UNet`,  


---

# ğŸš€ Overview

MedXFake provides a complete deep-fake framework for medical images:


âœ” **8-class ResNet synthetic deepfake detection**  
âœ” **Density based manipulation detector**  
âœ” **REST API**  
âœ” **Local HTML interface** ( **direct file access**)  

---

# ğŸ“ Repository Structure

```
project_root/
â”‚
â”œâ”€â”€ main_api.py
â”œâ”€â”€ main_interface.py
â”œâ”€â”€ manip_density_detect.py
â”œâ”€â”€ medical8_detect.py
â”‚
â”œâ”€â”€ templates/
â”‚    â””â”€â”€ index.html
â”‚
â”œâ”€â”€ static/
â”œâ”€â”€ data/
  â””â”€â”€ dataset_links.txt
â”œâ”€â”€ models/
  â”œâ”€â”€ Deep_Fake_Synthesis_Detection_Model.ipynb
  â”œâ”€â”€ Unet_Based_Manipulation_Localization.ipynb
â””â”€â”€ README.md
```

---

# ğŸ›¡ 1. Manipulation Detection (Density Map Based)

UNet based density map generation and bb determining.

### API Endpoint:
```
POST /detect/manipulation_density
```

---

# ğŸ§ª 4. 8-Class Synthetic DeepFake Detection

ResNet18 classifier for:
```
brain_real, brain_fake, chest_real, chest_fake,
kidney_real, kidney_fake, lung_real, lung_fake
```

### API Endpoint:
```
POST /detect/synthesis8
```

---

# ğŸŒ 5. Web Interface (IMPORTANT)

âš  index.html **It is not served by FastAPI.**  
**It should be opened directly from the file.**

---

# ğŸ“¦ Installation

```
pip install -r requirements.txt
```

---

# ğŸ“¥ Model Download Links

Place all models into:
```
models/
```

[From this link:](https://drive.google.com/drive/folders/13EO07JTrHvH9Cy8GcDb8xsE55bN300yF)

---
---

## ğŸ” Reproducibility and Re-training Support

In addition to pretrained model weights, this repository includes **Jupyter Notebook files (`.ipynb`) under the `models/` directory** that provide the **full training pipelines** for both synthesis detection and manipulation localization tasks. These notebooks are intentionally shared to support **reproducibility, transparency, and extensibility** of the proposed methods.

Specifically:

- **`Deep_Fake_Synthesis_Detection_Model.ipynb`** contains the complete training and evaluation pipeline for the **8-class ResNet-based synthesis deepfake detection model**, including dataset preparation, backbone configuration, and performance evaluation.
- **`Unet_Based_Manipulation_Localization.ipynb`** provides the end-to-end implementation for **U-Net-based density map generation and manipulation localization**, including loss design, threshold-based ablation analysis, and bounding box extraction from density maps.

By providing both pretrained models and training notebooks, **MedFakeDet** allows researchers and practitioners to:

- retrain the models on new or MedFake and MedFakeInpaint datasets,
- reproduce the reported experimental results,
- perform further ablation studies or architectural modifications.

This design choice strengthens the **reproducible software contribution** aspect of the study and aligns with best practices for research-oriented software dissemination.

---


---

MIT License
